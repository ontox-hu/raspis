[{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"workflow describes retrieve information (PubChem cid synonyms) given compound inchi, using NCBI Entrez PUG-REST API. vignette also used create datsets {raspis} package: merged_source_cid_synonyms merged_source_cid_synonyms_tidy smiles_cid smiles_cid_synonyms smiles_cid_synonyms_tidy smiles_cid_tidy data_source See ?raspis::dataset_name info","code":""},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"packages","dir":"Articles","previous_headings":"","what":"Packages","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"","code":"library(raspis) library(tidyr) library(dplyr) library(janitor) library(webchem) library(tibble) # install.packages(\"googlesheets4\") library(googlesheets4)"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"documentation","dir":"Articles","previous_headings":"","what":"Documentation","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"{rentrez} {webchem}","code":""},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"list-of-chemicals","dir":"Articles","previous_headings":"","what":"List of chemicals","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"load Googlesheet file containing compound info ASPIS project cluster build query perform search. People access file url file, can reproduce results obtained demo. see workflow use R connect Googlesheets: https://www.r-bloggers.com/2021/12/--connect-r--google-sheets-using-googlesheets4/ initiate authentication Google account run gs4_auth() Console. presented option select eaxisting google account add new one. may choose link current session already cached token (press enter selecting apporpriate Google account), choose ‘0’ obtain new token. Googlesheet trying access ‘everybody link access’ mode. need authenticate. can use gs4_deauth() , case safer use. url sheet stored cached value, show code. use RStudio API achieve .","code":"data_source <- read_sheet(url_sheet) data_source ## # A tibble: 790 × 12 ##    `Compound Name`       IUPAC Inchi SMILES `CAS Number` DTXSID `Project ID (R…` ##    <chr>                 <chr> <chr> <chr>  <list>       <chr>  <chr>            ##  1 diclofenac            2-[2… InCh… O=C(O… <chr [1]>    DTXSI… RH0000           ##  2 midazolam             8-ch… InCh… Cc1nc… <chr [1]>    DTXSI… RH0001           ##  3 tolbutamide           1-bu… InCh… CCCCN… <chr [1]>    DTXSI… RH0003           ##  4 haloperidol           4-[4… InCh… O=C(C… <chr [1]>    DTXSI… RH0004           ##  5 cyclosporine A        (3S,… InCh… C/C=C… <chr [1]>    DTXSI… RH0005           ##  6 propanolol            1-na… InCh… CC(C)… <chr [1]>    DTXSI… RH0006           ##  7 1,2-Benzisothiazolin… 1,2-… InCh… O=c1[… <chr [1]>    DTXSI… RH0007           ##  8 1,4‐Phenylenediamine  2,6-… InCh… Nc1cc… <chr [1]>    DTXSI… RH0008           ##  9 2,5-Diaminotoluene s… 2-me… InCh… OS(O)… <chr [1]>    DTXSI… RH0009           ## 10 2‑Methylisothiazolin… 2-me… InCh… Cn1sc… <chr [1]>    DTXSI… RH0010           ## # … with 780 more rows, and 5 more variables: `Project ID (ONTOX)` <chr>, ## #   `Project ID (PrecisionTox)` <lgl>, `Used in RISK-HUNT3R` <lgl>, ## #   `Used in ONTOX` <lgl>, `Used in PrecisionTox` <lgl> #usethis::use_data(data_source)"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"clean-and-select-data","dir":"Articles","previous_headings":"","what":"Clean and select data","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"Let’s clean reduce amount data. Steps take: Clean variable names make unix-safe file tidy, columns “Project ID (RISK-HUNT3R)”, “Project ID (ONTOX)”, “Project ID (PrecisionTox)”, “Used RISK-HUNT3R”, “Used ONTOX”, “Used PrecisionTox” contain variables (project_id & used_in_project), spread multiple columns. tidy 2 columns: project_id used_in_project, using unite() function tidyr package.","code":"data_source <- janitor::clean_names(data_source)  names(data_source) ##  [1] \"compound_name\"            \"iupac\"                    ##  [3] \"inchi\"                    \"smiles\"                   ##  [5] \"cas_number\"               \"dtxsid\"                   ##  [7] \"project_id_risk_hunt3r\"   \"project_id_ontox\"         ##  [9] \"project_id_precision_tox\" \"used_in_risk_hunt3r\"      ## [11] \"used_in_ontox\"            \"used_in_precision_tox\" data_source |>   mutate(     project_id_risk_hunt3r = ifelse(       is.na(project_id_risk_hunt3r),        \"\",        project_id_risk_hunt3r)   ) |>   mutate(     project_id_ontox = ifelse(       is.na(project_id_ontox),        \"\",        project_id_ontox)   ) |>   mutate(     project_id_precision_tox = ifelse(       is.na(project_id_precision_tox),        \"\",        project_id_precision_tox)   ) |>   tidyr::unite(     col = \"project_id\",      project_id_risk_hunt3r: project_id_precision_tox,     sep = \"<>\" ## add a token to be able to recognize the ids per project   ) |>    tidyr::unite(     col = \"used_in_project\",      used_in_risk_hunt3r:used_in_precision_tox,     sep = \"<>\" ## add a token to be able to recognize the values per project     ) -> data_source_tidy"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"some-checks-on-duplicates","dir":"Articles","previous_headings":"","what":"Some checks on duplicates","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"26 rows value inchi.","code":"data_source_tidy |>    group_by(smiles) |>   tally() |>   dplyr::filter(n > 1) -> aspis_duplicated_smiles aspis_duplicated_smiles ## # A tibble: 26 × 2 ##    smiles                                                                      n ##    <chr>                                                                   <int> ##  1 \"C(CN)C(O)(P(=O)(O)O)P(=O)(O)O\"                                             2 ##  2 \"C(CO)O\"                                                                    2 ##  3 \"C[C@@H]1[C@H]2[C@@H]([C@H]3[C@@H](C(=O)C(=C([C@]3(C(=O)C2=C(C4=C1C=CC…     2 ##  4 \"C[C@@H]1C[C@@H]([C@@H]2[C@H](C[C@H]([C@@](O2)(C(=O)C(=O)N3CCCC[C@H]3C…     2 ##  5 \"C[C@@H]1C[C@H]2[C@@H]3CCC4=CC(=O)C=C[C@@]4([C@]3([C@H](C[C@@]2([C@]1(…     2 ##  6 \"C[C@H](CS)C(=O)N1CCC[C@H]1C(=O)O\"                                          2 ##  7 \"C=CC(=O)N\"                                                                 2 ##  8 \"C1=CC=C(C=C1)C2=CC(=O)C3=C(O2)C=CC4=CC=CC=C43\"                             2 ##  9 \"C1C2=CN=C(N2C3=C(C=C(C=C3)Cl)C(=N1)C4=CC=CC=C4F)CO[C@H]5[C@@H]([C@H](…     2 ## 10 \"C1CCC(C1)(C(=O)O)N\"                                                        2 ## # … with 16 more rows #usethis::use_data(aspis_duplicated_smiles)"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"can-we-see-which-chemicals-are-selected-in-two-or-more-projects","dir":"Articles","previous_headings":"","what":"Can we see which chemicals are selected in two or more projects","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"know inspecting data value “RH0106<>CMS-7713<>” project_id indicates compound selected RISKHUNT3R ONTOX. Let’s see inchi belongs compound. one duplicates? ????","code":"data_source_tidy |>   dplyr::filter(     project_id == \"RH0106<>CMS-7713<>\"   ) -> x  x$smiles ## [1] \"C[C@@H]1[C@H]2[C@@H]([C@H]3[C@@H](C(=O)C(=C([C@]3(C(=O)C2=C(C4=C1C=CC=C4O)O)O)O)C(=O)N)N(C)C)O\" aspis_duplicated_smiles |>   dplyr::filter(     smiles == x$smiles   ) ## # A tibble: 1 × 2 ##   smiles                                                                       n ##   <chr>                                                                    <int> ## 1 C[C@@H]1[C@H]2[C@@H]([C@H]3[C@@H](C(=O)C(=C([C@]3(C(=O)C2=C(C4=C1C=CC=C…     2"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"add-cid","dir":"Articles","previous_headings":"","what":"Add CID","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"start clean query PubChem, continue unique inchi values compound ASPIS chemical set. CID PubChem id. need id things.","code":"data_source_tidy$smiles |>    unique() |>   enframe(name = \"index\", value = \"smiles\") -> smiles_unique smiles_unique ## # A tibble: 764 × 2 ##    index smiles                                                                  ##    <int> <chr>                                                                   ##  1     1 O=C(O)Cc1ccccc1Nc1c(Cl)cccc1Cl                                          ##  2     2 Cc1ncc2n1-c1ccc(Cl)cc1C(c1ccccc1F)=NC2                                  ##  3     3 CCCCNC(=O)NS(=O)(=O)c1ccc(C)cc1                                         ##  4     4 O=C(CCCN1CCC(O)(c2ccc(Cl)cc2)CC1)c1ccc(F)cc1                            ##  5     5 C/C=C/C[C@@H](C)[C@@H](O)[C@H]1C(=O)N[C@@H](CC)C(=O)N(C)CC(=O)N(C)[C@@… ##  6     6 CC(C)NCC(O)COc1cccc2ccccc12                                             ##  7     7 O=c1[nH]sc2ccccc12                                                      ##  8     8 Nc1ccc(N)cc1                                                            ##  9     9 OS(O)(=O)=O.Cc1cc(N)ccc1N                                               ## 10    10 Cn1sccc1=O                                                              ## # … with 754 more rows ## get all CID for all chemicals by name ## wrap get_cid() in function with a pause, not to overburden the NCBI server. get_cid_with_pause <- function(..., wait = 0.5){      x <- get_cid(...)   profvis::pause(wait)   return(x)    }  hold = 2  smiles_cid <- smiles_unique |>   mutate(     cid = map(     .x = smiles,     get_cid_with_pause,     verbose = TRUE,     from = 'smiles',     wait = hold)   ) #usethis::use_data(smiles_cid)  smiles_cid_tidy <- smiles_cid |>   unnest(cid) %>%   dplyr::select(-query)  ## store dataset in package #usethis::use_data(smiles_cid_tidy, overwrite = TRUE)"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"check-cid-for-missingness-and-uniqueness","dir":"Articles","previous_headings":"","what":"Check cid for missingness and uniqueness","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"code can conclude : missing cid. means values inchi matching cid returned PubChem database. means project, remains seen. value cid matching unique value smiles. expected cid smiles resolvable ids.","code":"## load datset from package data(package = \"raspis\", \"smiles_cid_tidy\") ## are there inchi values that did not match to any CID? smiles_cid_tidy$cid |>   is.na() |>   sum() ## [1] 62 naniar::vis_miss(smiles_cid_tidy) ## is every cid matched to a unique cid? smiles_cid_tidy |>   group_by(smiles) |>   tally() |>   dplyr::filter(n >1) -> x x$n ## integer(0)"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"enrich-compound-data-with-synonyms","dir":"Articles","previous_headings":"","what":"Enrich compound data with synonyms","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"add synonyms row cid . reduce number queries, use complete records (inchi cid). See PUG-REST API PubChem attributes can retrieved.","code":"get_synonyms_with_pause <- function(..., wait = 0.5){      x <- pc_synonyms(...)   profvis::pause(wait)   return(x)    }  hold = 2  smiles_cid_synonyms <- smiles_cid_tidy |>   na.omit() |>   mutate(     synonyms = map(       cid,       get_synonyms_with_pause,       from = \"cid\",       wait = hold,        verbose = TRUE))   #usethis::use_data(smiles_cid_synonyms)  smiles_cid_synonyms_tidy <- smiles_cid_synonyms |>   unnest_longer(synonyms) |>   unnest_longer(synonyms) ## write as dataset to package #usethis::use_data(smiles_cid_synonyms_tidy)"},{"path":"/articles/aspis-chemcicals-cid-synonyms.html","id":"result","dir":"Articles","previous_headings":"","what":"Result","title":"Retrieve PubChem cid and synonyms for each ASPIS compound","text":"","code":"smiles_cid_synonyms_tidy |> head(5) ## # A tibble: 5 × 5 ##   index smiles                         cid   synonyms        synonyms_id ##   <int> <chr>                          <chr> <chr>           <chr>       ## 1     1 O=C(O)Cc1ccccc1Nc1c(Cl)cccc1Cl 3033  diclofenac      3033        ## 2     1 O=C(O)Cc1ccccc1Nc1c(Cl)cccc1Cl 3033  15307-86-5      3033        ## 3     1 O=C(O)Cc1ccccc1Nc1c(Cl)cccc1Cl 3033  Diclofenac acid 3033        ## 4     1 O=C(O)Cc1ccccc1Nc1c(Cl)cccc1Cl 3033  dichlofenac     3033        ## 5     1 O=C(O)Cc1ccccc1Nc1c(Cl)cccc1Cl 3033  Voltaren        3033"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Marc Teunis. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Teunis M (2022). raspis: ASPIS Cluster chemical collection datasets. R package version 0.0.1.","code":"@Manual{,   title = {raspis: The ASPIS Cluster chemical collection datasets},   author = {Marc Teunis},   year = {2022},   note = {R package version 0.0.1}, }"},{"path":[]},{"path":"/index.html","id":"the-raspis-r-package","dir":"","previous_headings":"","what":"The {raspis} R package","title":"The ASPIS Cluster chemical collection datasets","text":"R package containing ASPIS chemicals collection datasets can read directly R package. learn follow instructions . use data sets can install {raspis} R.","code":""},{"path":"/index.html","id":"aspis","dir":"","previous_headings":"The {raspis} R package","what":"ASPIS","title":"The ASPIS Cluster chemical collection datasets","text":"ASPIS cluster three EU Horizon 2020 funded projects directed toxicology. cluster consists : RISK-HUNT3R ONTOX PrecisionTox Follow link information ASPIS.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"The {raspis} R package","what":"Installation","title":"The ASPIS Cluster chemical collection datasets","text":"Run following commands R","code":"install.packages(\"remotes\") remotes::install_github(\"ontox-hu/raspis\") library(raspis)"},{"path":"/index.html","id":"datasets","dir":"","previous_headings":"The {raspis} R package","what":"Datasets","title":"The ASPIS Cluster chemical collection datasets","text":"see datasets: use one datasets:","code":"data(package = \"raspis\") data(package = \"raspis\", dataset = <dataset_name>)"},{"path":"/index.html","id":"documentation","dir":"","previous_headings":"The {raspis} R package","what":"Documentation","title":"The ASPIS Cluster chemical collection datasets","text":"see documentation:","code":"library(raspis) browseVignettes(\"raspis\")"},{"path":"/index.html","id":"source","dir":"","previous_headings":"The {raspis} R package","what":"Source","title":"The ASPIS Cluster chemical collection datasets","text":"details source code visit {raspis} Github page","code":""},{"path":"/reference/data_source.html","id":null,"dir":"Reference","previous_headings":"","what":"Orignal source file as obtained from the ASPIS project cluster on\nGoogle Drive — data_source","title":"Orignal source file as obtained from the ASPIS project cluster on\nGoogle Drive — data_source","text":"dataset containing information (ids) 790 compounds, collected three Horizon 2020 projects (RISK-HUNT3R, ONTOX PrecisionTox), organized umbrella organization called ASPIS. See ASPIS details.","code":""},{"path":"/reference/data_source.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Orignal source file as obtained from the ASPIS project cluster on\nGoogle Drive — data_source","text":"","code":"data_source"},{"path":"/reference/data_source.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Orignal source file as obtained from the ASPIS project cluster on\nGoogle Drive — data_source","text":"data frame 790 rows 12 variables: Compound Name generic name compound IUPAC Standardized IUPAC chemical name Inchi inchi compound SMILES SMILES string conceptualize molecular structure CAS number number according CAS registry DTXSID EPA CompTox Dashboard compound id Project ID (RISK-HUNT3R) Internal id RISK-HUNT3R project Project ID (ONTOX) Internal id ONTOX project Project ID (PrecisionTox) Internal id PrecisionTox project Used RISK-HUNT3R Whether compound used RISK-HUNT3R Used ONTOX Whether compound used ONTOX Used PrecisionTox Whether compound used PrecisionTox","code":""},{"path":"/reference/data_source.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Orignal source file as obtained from the ASPIS project cluster on\nGoogle Drive — data_source","text":"Google Drive","code":""},{"path":"/reference/merged_source_cid_synonyms.html","id":null,"dir":"Reference","previous_headings":"","what":"Data set on compounds from the ASPIS cluster of projects,\nenriched for PubChem CID en compound synonyms — merged_source_cid_synonyms","title":"Data set on compounds from the ASPIS cluster of projects,\nenriched for PubChem CID en compound synonyms — merged_source_cid_synonyms","text":"data set containing information (ids) 790 compounds, collected three Horizon 2020 projects (RISK-HUNT3R, ONTOX PrecisionTox), organized umbrella organization called ASPIS. See ASPIS details ASPIS.","code":""},{"path":"/reference/merged_source_cid_synonyms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data set on compounds from the ASPIS cluster of projects,\nenriched for PubChem CID en compound synonyms — merged_source_cid_synonyms","text":"","code":"merged_source_cid_synonyms"},{"path":"/reference/merged_source_cid_synonyms.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data set on compounds from the ASPIS cluster of projects,\nenriched for PubChem CID en compound synonyms — merged_source_cid_synonyms","text":"data frame 790 rows 12 variables: compound_name generic name compound iupac Standardized IUPAC chemical name inchi inchi compound smiles SMILES string conceptualize molecular structure cas_number number according CAS registry dtxsid EPA CompTox Dashboard compound id project_id Internal id projects used_in_project Whether compound used project cid Id record PubChem Database synonyms Synonym compound retrieved PubChem Database","code":""},{"path":"/reference/merged_source_cid_synonyms.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data set on compounds from the ASPIS cluster of projects,\nenriched for PubChem CID en compound synonyms — merged_source_cid_synonyms","text":"Google Drive","code":""},{"path":"/reference/merged_source_cid_synonyms.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data set on compounds from the ASPIS cluster of projects,\nenriched for PubChem CID en compound synonyms — merged_source_cid_synonyms","text":"data set enriched version dataset \"data_source\" also available {raspis}. data enriched PubChem CID compound synonyms, obtained via NCBI PUG-REST API). Steps taken enrichment described package Vignette. Run browseVignettes(package = \"raspis\") see Vignette(s). also tidy version data set available raspis::merged_source_cid_synonyms_tidy","code":""},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""}]
